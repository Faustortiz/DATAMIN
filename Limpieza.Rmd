---
title: "Untitled"
author: "Fausto Ortiz"
date: "7/12/2020"
output: pdf_document
---

###########
# Carga de libre√≠as y datos.
##########

```{r}
library("dplyr")
library("gdata")
library("corrplot")
library("moments")
library("fastDummies")
library("ggplot2")
library("psych")
library("car")
library("corrplot")
library("caret")
library("lubridate")

```


Carga de datos

```{r}
datos <- read.csv("ToyotaCorollaLimpio.csv")
datos

```

```{r}
datos$X <- NULL
```


```{r}
sum(is.na(datos))
datos = na.omit(datos)
```

```{r}
str(datos)
```
```{r}
deleteme = datos
#deleteme$Fuel_Type = as.factor(datos$Fuel_Type)
#deleteme$Mfg_Month =  as.factor(datos$Mfg_Month)
deleteme$Mfg_Year = as.factor(datos$Mfg_Year)
deleteme$Met_Color = as.factor(datos$Met_Color)
deleteme$Automatic = as.factor(datos$Automatic)
deleteme$Doors = as.factor(datos$Doors)
#deleteme$Cylinders = as.factor(datos$Cylinders)
deleteme$Gears = as.factor(datos$Gears)
deleteme$Mfr_Guarantee = as.factor(datos$Mfr_Guarantee)
deleteme$BOVAG_Guarantee = as.factor(datos$BOVAG_Guarantee)
deleteme$Guarantee_Period = as.factor(datos$Guarantee_Period)
deleteme$ABS = as.factor(datos$ABS)
deleteme$Airbag_1 = as.factor(datos$Airbag_1)
deleteme$Airbag_2 = as.factor(datos$Airbag_2)
deleteme$Airco = as.factor(datos$Airco)
deleteme$Automatic_airco = as.factor(datos$Automatic_airco)
deleteme$Boardcomputer = as.factor(datos$Boardcomputer)
deleteme$CD_Player = as.factor(datos$CD_Player)
deleteme$Central_Lock = as.factor(datos$Central_Lock)
#deleteme$Power_Windows = as.factor(datos$Powered_Windows)
deleteme$Power_Steering = as.factor(datos$Power_Steering)
deleteme$Radio = as.factor(datos$Radio)
deleteme$Mistlamps = as.factor(datos$Mistlamps)
deleteme$Sport_Model = as.factor(datos$Sport_Model)
deleteme$Backseat_Divider = as.factor(datos$Backseat_Divider)
deleteme$Metallic_Rim = as.factor(datos$Metallic_Rim)
deleteme$Radio_cassette = as.factor(datos$Radio_cassette)
deleteme$Tow_Bar = as.factor(datos$Tow_Bar)
        

str(deleteme)
```

```{r}
par(mfrow = c(1,2))
boxplot(datos$Price, main="Price")
boxplot(datos$Age_08_04, main = "Age_08_04")
boxplot(datos$Mfg_Year, main = "Mfg_Year")
boxplot(datos$KM, main = "KM")
boxplot(datos$HP, main = "HP")
boxplot(datos$Met_Color, main = "Met Color")
#pie(summary(factorizado$waterfront),labels = c("no", "si"), main = "waterfront")
boxplot(datos$Automatic, main = "Automatic")
boxplot(datos$cc, main = "cc")
boxplot(datos$Doors, main = "Doors")
boxplot(datos$Gears, main = "Gears")
boxplot(datos$Quarterly_Tax, main = "Quarterly Tax")
boxplot(datos$Weight, main = "Weight")
boxplot(datos$Mfr_Guarantee, main = "Mfr Guarantee")
boxplot(datos$BOVAG_Guarantee, main = "Bovag Guarantee")
boxplot(datos$Guarantee_Period, main = "Guarante period")
boxplot(datos$ABS, main = "ABS")
boxplot(datos$Airbag_1, main = "Airbag 1")
boxplot(datos$Airbag_2, main = "Airbag 2")
boxplot(datos$Airco, main = "Airco")
boxplot(datos$Automatic_airco, main = "Automatic Airco")
boxplot(datos$Boardcomputer, main = "Board Computer")
boxplot(datos$CD_Player, main ="Cd Player")
boxplot(datos$Central_Lock, main = "central lock")
boxplot(datos$Powered_Windows, main = "Powered Windows")
boxplot(datos$Power_Steering, main = "Power sterring")
boxplot(datos$Radio, main = "Radio")
boxplot(datos$Mistlamps, main = "Mistlamps")
boxplot(datos$Sport_Model, main = "Sport model")
boxplot(datos$Backseat_Divider, main = "Backseat divider")
boxplot(datos$Metallic_Rim, main ="Metalic rim")
boxplot(datos$Radio_cassette, main="Radio Casette")
boxplot(datos$Tow_Bar, main = "Tow bar")
```

```{r}
boxplot(datos$Price)
```
Observamos que el precio tiene una media de 10.000 por lo que pasando los 15.000 es considerados posibles outliers y vamos a proceder a eliminarlo para tener una mejor representativida de las variables.
```{r}
datos <- filter(datos, !(Price>14000))
datos <- filter(datos, !(Price<5000))
datos <- filter(datos, !(KM>130000))
datos <- filter(datos, !(cc>1900))
datos <- filter(datos, !(Age_08_04<30))

```

```{r}
boxplot(datos$Price)
```
```{r}
par(mfrow = c(1,2))
boxplot(datos$Price, main="Price")
boxplot(datos$Age_08_04, main = "Age_08_04")
boxplot(datos$Mfg_Year, main = "Mfg_Year")
boxplot(datos$KM, main = "KM")
boxplot(datos$HP, main = "HP")
boxplot(datos$Met_Color, main = "Met Color")
#pie(summary(factorizado$waterfront),labels = c("no", "si"), main = "waterfront")
boxplot(datos$Automatic, main = "Automatic")
boxplot(datos$cc, main = "cc")
boxplot(datos$Doors, main = "Doors")
boxplot(datos$Gears, main = "Gears")
boxplot(datos$Quarterly_Tax, main = "Quarterly Tax")
boxplot(datos$Weight, main = "Weight")
boxplot(datos$Mfr_Guarantee, main = "Mfr Guarantee")
boxplot(datos$BOVAG_Guarantee, main = "Bovag Guarantee")
boxplot(datos$Guarantee_Period, main = "Guarante period")
boxplot(datos$ABS, main = "ABS")
boxplot(datos$Airbag_1, main = "Airbag 1")
boxplot(datos$Airbag_2, main = "Airbag 2")
boxplot(datos$Airco, main = "Airco")
boxplot(datos$Automatic_airco, main = "Automatic Airco")
boxplot(datos$Boardcomputer, main = "Board Computer")
boxplot(datos$CD_Player, main ="Cd Player")
boxplot(datos$Central_Lock, main = "central lock")
boxplot(datos$Powered_Windows, main = "Powered Windows")
boxplot(datos$Power_Steering, main = "Power sterring")
boxplot(datos$Radio, main = "Radio")
boxplot(datos$Mistlamps, main = "Mistlamps")
boxplot(datos$Sport_Model, main = "Sport model")
boxplot(datos$Backseat_Divider, main = "Backseat divider")
boxplot(datos$Metallic_Rim, main ="Metalic rim")
boxplot(datos$Radio_cassette, main="Radio Casette")
boxplot(datos$Tow_Bar, main = "Tow bar")
```
Aplicando esta limpieza quedmaos con un dataset representativo muy bueno sin tener grupos de outlier y con un porcentaje del 76% del dataset original lo que podemos concluir que el dataset no pierde representativida en los datos.

```{r}

write.csv(datos, file= "ToyotaCorollaLimpio2.csv")


```

```{r}
dataset <- read.csv("ToyotaCorollaLimpio2.csv")
dataset$X <- NULL
```


